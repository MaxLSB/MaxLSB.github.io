---
import { getCollection } from "astro:content";
import BaseLayout from "../../components/layout/BaseLayout.astro";
import BaseHero from "../../components/shared/BaseHero.astro";
import ArticleCard from "../../components/ui/ArticleCard.astro";
import Container from "../../components/ui/Container.astro";
import ContentList from "../../components/shared/ContentList.astro";

const publications = await getCollection("publications");
const sortedPublications = publications.sort((a, b) => b.data.year - a.data.year);
---

<BaseLayout title="Publications" description="Research papers and academic publications">
  <Container>
    <BaseHero title="Publications" description="Research papers and academic publications" />
    <ContentList>
      {
        sortedPublications.map((publication) => {
          const additionalLinks = [];
          if (publication.data.pdf && publication.data.pdf !== publication.data.url) {
            additionalLinks.push({ label: "PDF", url: publication.data.pdf });
          }
          
          return (
            <ArticleCard
              title={publication.data.title}
              description={`${publication.data.authors.join(", ")} - ${publication.data.venue} (${publication.data.year})`}
              url={`/publications/${publication.id}/`}
              date={publication.data.date ? new Date(publication.data.date) : new Date(publication.data.year, 0, 1)}
              additionalLinks={additionalLinks}
              noBorder={true}
            />
          );
        })
      }
    </ContentList>
  </Container>
</BaseLayout>
